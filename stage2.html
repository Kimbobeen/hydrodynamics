<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>점탄성 유체 공정 시뮬레이터 - 안내 및 선택지</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #4fc3f7 0%, #81c784 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Segoe UI', sans-serif;
    }
    .info-container, .stage-container, .fail-container {
      color: #1976d2;
      font-size: 1.1rem;
      text-align: center;
      padding: 40px 20px;
      background: rgba(220, 245, 255, 0.85);
      border-radius: 20px;
      box-shadow: 0 8px 32px 0 rgba(129,199,132,0.15);
      min-width: 400px;
      min-height: 500px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .info-box {
      background: #fff9c4;
      color: #b8860b;
      border-radius: 16px;
      padding: 32px 18px;
      font-size: 1.15rem;
      font-weight: bold;
      box-shadow: 0 2px 8px #ffe08288;
      max-width: 350px;
      text-align: center;
      margin-bottom: 32px;
    }
    .next-btn {
      margin: 0 auto;
      padding: 14px 32px;
      font-size: 1.1rem;
      font-weight: bold;
      color: #fff;
      background: linear-gradient(90deg, #ffd54f 0%, #ffb300 100%);
      border: none;
      border-radius: 28px;
      cursor: pointer;
      box-shadow: 0 2px 8px #ffd54f55;
      transition: background 0.3s, transform 0.2s;
      display: block;
    }
    .next-btn:hover {
      background: linear-gradient(90deg, #ffb300 0%, #ffd54f 100%);
      transform: scale(1.04);
    }
    .honey-illustration {
      margin: 0 auto 24px auto;
      position: relative;
      width: 220px;
      height: 320px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .nozzle {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 40px;
      background: #64b5f6;
      border-radius: 20px 20px 30px 30px;
      z-index: 2;
      border: 3px solid #1976d2;
      box-shadow: 0 2px 8px #1976d233;
    }
    .honey-flow {
      position: absolute;
      top: 35px;
      left: 50%;
      transform: translateX(-50%);
      width: 24px;
      height: 120px;
      background: linear-gradient(180deg, #ffd54f 60%, #ffb300 100%);
      border-radius: 16px;
      z-index: 1;
      animation: honeyDrop 1.2s infinite alternate;
      box-shadow: 0 0 16px #ffd54f88;
    }
    @keyframes honeyDrop {
      0% { height: 100px; }
      100% { height: 130px; }
    }
    .jar {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 160px;
      background: #fffde7;
      border: 6px solid #81c784;
      border-radius: 40px 40px 60px 60px / 60px 60px 100px 100px;
      z-index: 2;
      box-shadow: 0 8px 32px #81c78444;
      overflow: hidden;
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }
    .jar-honey {
      width: 100px;
      height: 70px;
      background: linear-gradient(180deg, #ffd54f 60%, #ffb300 100%);
      border-radius: 0 0 50px 50px / 0 0 60px 60px;
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3;
      box-shadow: 0 0 16px #ffd54f88;
    }
    .question-label {
      margin-bottom: 0;
      color: #1976d2;
      font-size: 1.2rem;
      font-weight: bold;
      text-shadow: 1px 2px 8px #b2ebf2cc;
      background: rgba(129, 212, 250, 0.7);
      border-radius: 12px;
      padding: 12px 0;
      width: 320px;
      max-width: 90vw;
      display: block;
      margin-left: auto;
      margin-right: auto;
      position: absolute;
      top: -56px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 20;
    }
    .choice-box {
      margin: 40px auto 0 auto;
      background: #fff9c4;
      border-radius: 16px;
      padding: 24px 18px;
      box-shadow: 0 2px 8px #ffe08288;
      max-width: 350px;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .choice-btn {
      padding: 16px 32px;
      font-size: 1.1rem;
      font-weight: bold;
      color: #1976d2;
      background: linear-gradient(90deg, #b3e5fc 0%, #4fc3f7 100%);
      border: none;
      border-radius: 28px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(79,195,247,0.3);
      transition: background 0.3s, transform 0.2s;
      width: 100%;
      max-width: 320px;
      margin: 0 auto;
    }
    .choice-btn:hover {
      background: linear-gradient(90deg, #4fc3f7 0%, #b3e5fc 100%);
      transform: scale(1.04);
    }
    /* 실패 애니메이션 및 결과 */
    .fail-illustration {
      margin: 0 auto 24px auto;
      position: relative;
      width: 220px;
      height: 320px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .fail-nozzle {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 40px;
      background: #64b5f6;
      border-radius: 20px 20px 30px 30px;
      z-index: 2;
      border: 3px solid #1976d2;
      box-shadow: 0 2px 8px #1976d233;
    }
    .fail-honey-flow {
      position: absolute;
      top: 35px;
      left: 50%;
      transform: translateX(-50%);
      width: 24px;
      background: linear-gradient(180deg, #ffd54f 60%, #ffb300 100%);
      border-radius: 16px;
      z-index: 1;
      box-shadow: 0 0 16px #ffd54f88;
    }
    .fail-jar {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 160px;
      background: #fffde7;
      border: 6px solid #81c784;
      border-radius: 40px 40px 60px 60px / 60px 60px 100px 100px;
      z-index: 2;
      box-shadow: 0 8px 32px #81c78444;
      overflow: hidden;
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }
    .fail-jar-honey {
      width: 100px;
      height: 70px;
      background: linear-gradient(180deg, #ffd54f 60%, #ffb300 100%);
      border-radius: 0 0 50px 50px / 0 0 60px 60px;
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3;
      box-shadow: 0 0 16px #ffd54f88;
    }
    .fail-label-box {
      display: none;
      margin: 30px auto 0 auto;
      background: #fff9c4;
      color: #b8860b;
      border-radius: 16px;
      padding: 24px 18px;
      font-size: 1.1rem;
      font-weight: bold;
      box-shadow: 0 2px 8px #ffe08288;
      max-width: 350px;
      text-align: center;
    }
    .retry-btn {
      display: none;
      margin: 18px auto 0 auto;
      padding: 14px 32px;
      font-size: 1.1rem;
      font-weight: bold;
      color: #fff;
      background: linear-gradient(90deg, #ffd54f 0%, #ffb300 100%);
      border: none;
      border-radius: 28px;
      cursor: pointer;
      box-shadow: 0 2px 8px #ffd54f55;
      transition: background 0.3s, transform 0.2s;
    }
    .retry-btn:hover {
      background: linear-gradient(90deg, #ffb300 0%, #ffd54f 100%);
      transform: scale(1.04);
    }
    @media (max-width: 500px) {
      .info-container, .stage-container, .fail-container {
        min-width: 90vw;
        padding: 10px 2vw;
      }
      .honey-illustration, .fail-illustration {
        width: 90vw;
        height: 60vw;
        min-width: 180px;
        min-height: 220px;
      }
      .question-label {
        width: 90vw;
        font-size: 1rem;
        top: -44px;
      }
      .choice-box, .fail-label-box, .info-box {
        max-width: 90vw;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- 안내(설명) 화면 -->
  <div class="info-container" id="infoPage">
    <div class="info-box">
      급격한 단면변화를 방지하여 탄성에너지의 급격한 방출을 막아내었습니다.<br>
      이로써 '바러스 효과'를 성공적으로 억제하였습니다.
    </div>
    <button class="next-btn" id="nextBtn">다음</button>
  </div>
  <!-- 질문/선택지 화면 (처음엔 숨김) -->
  <div class="stage-container" id="stagePage" style="display:none; position:relative;">
    <div class="honey-illustration" style="margin-top:56px;">
      <div class="question-label">
        '액체 로프 코일링 효과'로 인해 뚜껑이 더러워질 가능성이 큽니다. 어떻게 해야할까요?
      </div>
      <div class="nozzle"></div>
      <div class="honey-flow"></div>
      <div class="jar">
        <div class="jar-honey"></div>
      </div>
    </div>
    <div class="choice-box">
      <button class="choice-btn" id="choice1">용기 밑에 일정한 속도로 회전하는 회전판을 놓는다</button>
      <button class="choice-btn" id="choice2">고정된 밑판을 사용한다</button>
    </div>
  </div>
  <!-- 실패 애니메이션 및 결과 화면 -->
  <div class="fail-container" id="failPage" style="display:none;">
    <div class="fail-illustration">
      <div class="fail-nozzle"></div>
      <div class="fail-honey-flow" id="failHoneyFlow"></div>
      <div class="fail-jar">
        <div class="fail-jar-honey"></div>
      </div>
    </div>
    <div class="fail-label-box" id="failLabelBox">
      고정된 밑판을 사용하여 '액체 로프 코일링 효과'가 발생했습니다.<br>
      다시 시도 하십시오
    </div>
    <button class="retry-btn" id="retryBtn">다시시도하기</button>
  </div>
  <script>
    // "다음" 버튼 클릭 시 안내 숨기고 질문/선택지 화면 보이기
    document.getElementById('nextBtn').onclick = function() {
      document.getElementById('infoPage').style.display = 'none';
      document.getElementById('stagePage').style.display = 'flex';
    };

    // 정답 선택지(회전판) 클릭 시 (예시: 다음 단계로 이동)
    // ...existing code...
// ...existing code...
document.getElementById('choice1').onclick = function() {
  // 안내 화면 삽입
  document.body.innerHTML = `
    <div class="result-box">
      같은 위치에 페인트가 떨어지지 않게 하여 유체의 압축력을 해소 시켰습니다.<br>
      이로써 성공적으로 '액체 로프 코일링 효과'를 억제시키는데 성공했습니다.<br>
      <b>모든 공정설계 단계를 완료했습니다!</b><br>
      이 화면을 앞에 멘토에게 보여주시면 소정의 상품을 드리겠습니다!!<br>
      게임을 플레이해주셔서 감사합니다
    </div>
    <canvas id="confetti-canvas"></canvas>
    <style>
      .result-box {
        background: #fffbe6;
        border: 2px solid #ffe066;
        border-radius: 16px;
        padding: 32px 24px;
        margin: 100px auto 0 auto;
        width: 80%;
        max-width: 500px;
        font-size: 1.2em;
        color: #333;
        text-align: center;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        position: relative;
        z-index: 1;
      }
      #confetti-canvas {
        position: fixed;
        pointer-events: none;
        top: 0; left: 0; width: 100vw; height: 100vh;
        z-index: 10;
      }
    </style>
  `;

  // 애니메이션 함수 실행
  runFireworkConfetti();
};

// 애니메이션 함수 정의
function runFireworkConfetti() {
  var canvas = document.getElementById('confetti-canvas');
  var ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  // 파티클(폭죽) 배열
  var fireworks = [];
  var colors = ['#ff595e','#ffca3a','#8ac926','#1982c4','#6a4c93','#fff','orange','cyan','magenta'];

  function Firework(x, y) {
    this.particles = [];
    for (var i = 0; i < 60; i++) {
      var angle = (Math.PI * 2) * (i / 60);
      var speed = 2 + Math.random() * 4;
      this.particles.push({
        x: x,
        y: y,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed,
        alpha: 1,
        color: colors[Math.floor(Math.random()*colors.length)]
      });
    }
  }
  Firework.prototype.update = function() {
    this.particles.forEach(function(p) {
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.04; // gravity
      p.vx *= 0.98;
      p.vy *= 0.98;
      p.alpha -= 0.012;
    });
  };
  Firework.prototype.draw = function(ctx) {
    this.particles.forEach(function(p) {
      if (p.alpha > 0) {
        ctx.save();
        ctx.globalAlpha = p.alpha;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 3, 0, Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.fill();
        ctx.restore();
      }
    });
  };

  // 여러 군데에서 폭죽 터뜨리기
  function launchFireworks() {
    for (var i = 0; i < 5; i++) {
      var fx = window.innerWidth * (0.2 + 0.15 * i) + (Math.random()-0.5)*60;
      var fy = window.innerHeight * (0.3 + Math.random()*0.2);
      fireworks.push(new Firework(fx, fy));
    }
  }
  launchFireworks();
  setTimeout(launchFireworks, 800);
  setTimeout(launchFireworks, 1600);

  // 바닥에서 confetti 파티클도 뿌리기
  var confetti = [];
  for (var i = 0; i < 120; i++) {
    confetti.push({
      x: Math.random() * canvas.width,
      y: Math.random() * -canvas.height,
      w: 8 + Math.random() * 8,
      h: 12 + Math.random() * 8,
      color: colors[Math.floor(Math.random()*colors.length)],
      speed: 2 + Math.random() * 3,
      angle: Math.random() * Math.PI * 2,
      alpha: 1
    });
  }

  function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // confetti
    confetti.forEach(function(p) {
      ctx.save();
      ctx.globalAlpha = p.alpha;
      ctx.translate(p.x, p.y);
      ctx.rotate(p.angle);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
      p.y += p.speed;
      p.angle += 0.02;
      if (p.y > canvas.height) {
        p.y = -20;
        p.x = Math.random() * canvas.width;
      }
    });

    // fireworks
    fireworks.forEach(function(fw) {
      fw.update();
      fw.draw(ctx);
    });

    requestAnimationFrame(draw);
  }
  draw();
}

    // 오답 선택지(고정된 밑판) 클릭 시 실패 애니메이션 및 결과
    document.getElementById('choice2').onclick = function() {
      document.getElementById('stagePage').style.display = 'none';
      document.getElementById('failPage').style.display = 'flex';

      // 초기화
      var honeyFlow = document.getElementById('failHoneyFlow');
      var labelBox = document.getElementById('failLabelBox');
      var retryBtn = document.getElementById('retryBtn');
      honeyFlow.style.height = '0px';
      honeyFlow.style.display = 'block';
      labelBox.style.display = 'none';
      retryBtn.style.display = 'none';

      // 꿀이 흐르는 애니메이션 (3초)
      var duration = 3000;
      var start = null;
      function animateHoneyFlow(timestamp) {
        if (!start) start = timestamp;
        var elapsed = timestamp - start;
        var maxHeight = 180;
        var height = Math.min(maxHeight, (elapsed / duration) * maxHeight);
        honeyFlow.style.height = height + 'px';
        honeyFlow.style.top = (35) + 'px';
        if (elapsed < duration) {
          requestAnimationFrame(animateHoneyFlow);
        } else {
          honeyFlow.style.display = 'none';
          // 1초 후 결과 박스와 버튼 표시
          setTimeout(function() {
            labelBox.style.display = 'block';
            retryBtn.style.display = 'block';
          }, 1000);
        }
      }
      requestAnimationFrame(animateHoneyFlow);
    };

    // 다시시도하기 버튼 클릭 시 선택지 화면으로 복귀
    document.getElementById('retryBtn').addEventListener('click', function() {
      document.getElementById('failPage').style.display = 'none';
      document.getElementById('stagePage').style.display = 'flex';
    });
// ...existing code...
// ...existing code...
// ...existing code...
// ...existing code...
// ...existing code...
document.getElementById('failBtn').onclick = function() {
  document.body.innerHTML = `
    <div class="fail-label-box" id="failLabelBox">
      고정된 밑판을 사용하여 '액체 로프 코일링 효과'가 발생했습니다.<br>
      다시 시도 하십시오
    </div>
    <div class="paint-area">
      <canvas id="cream-canvas" width="300" height="320" style="display:block;"></canvas>
    </div>
    <style>
      .fail-label-box {
        font-size: 1.2em;
        color: #b22222;
        margin: 40px auto 24px auto;
        text-align: center;
        background: #fffbe6;
        border: 2px solid #ffe066;
        border-radius: 16px;
        padding: 24px 16px;
        width: 80%;
        max-width: 500px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
      }
      .paint-area {
        position: relative;
        width: 300px;
        height: 320px;
        background: transparent;
        border-radius: 0 0 140px 140px/0 0 80px 80px;
        overflow: hidden;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        border: 2px solid #bbb;
        margin: 0 auto;
      }
      canvas#cream-canvas {
        display: block;
        position: relative;
        z-index: 1;
      }
    </style>
  `;

  creamOverflowAnimation();
};

function creamOverflowAnimation() {
  const canvas = document.getElementById('cream-canvas');
  const ctx = canvas.getContext('2d');
  const w = canvas.width, h = canvas.height;
  let creamLayers = [];
  let t = 0;
  let overflow = false;
  let overflowY = h - 40;
  let overflowStep = 0;
  let overflowDone = false;

  function addCreamLayer() {
    const baseY = h - 40 - creamLayers.length * 18;
    if (baseY < 80) return;
    const points = [];
    for (let i = 0; i <= 20; i++) {
      const x = 30 + i * 12;
      const y = baseY - Math.sin(i/2 + Math.random()*0.5 + t/8) * (8 + Math.random()*6);
      points.push({x, y});
    }
    creamLayers.push(points);
  }

  // 주입구(inlet) 그리기
  function drawInlet() {
    ctx.save();
    ctx.beginPath();
    ctx.rect(w/2-12, -60, 24, 60);
    ctx.fillStyle = "#aaa";
    ctx.shadowColor = "#888";
    ctx.shadowBlur = 4;
    ctx.fill();
    ctx.restore();
  }

  // 용기(배경) 그리기
  function drawContainer() {
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(30, h-20);
    ctx.bezierCurveTo(30, h-80, w-30, h-80, w-30, h-20);
    ctx.lineTo(w-30, h-20);
    ctx.lineTo(w-30, h-0);
    ctx.lineTo(30, h-0);
    ctx.closePath();
    ctx.fillStyle = "#e0e0e0";
    ctx.shadowColor = "#bbb";
    ctx.shadowBlur = 8;
    ctx.fill();
    ctx.lineWidth = 2;
    ctx.strokeStyle = "#bbb";
    ctx.stroke();
    ctx.restore();
  }

  function drawPaintStream() {
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(w/2-8, 0);
    ctx.lineTo(w/2+8, 0);
    ctx.lineTo(w/2+8, 40 + Math.min(creamLayers.length*18, h-120));
    ctx.lineTo(w/2-8, 40 + Math.min(creamLayers.length*18, h-120));
    ctx.closePath();
    ctx.fillStyle = "#ffb347";
    ctx.shadowColor = "#ffb347";
    ctx.shadowBlur = 8;
    ctx.fill();
    ctx.restore();
  }

  function drawCream() {
    for (let i = 0; i < creamLayers.length; i++) {
      ctx.save();
      ctx.beginPath();
      const pts = creamLayers[i];
      ctx.moveTo(pts[0].x, pts[0].y);
      for (let j = 1; j < pts.length; j++) {
        ctx.lineTo(pts[j].x, pts[j].y);
      }
      ctx.lineTo(pts[pts.length-1].x, h-20);
      ctx.lineTo(pts[0].x, h-20);
      ctx.closePath();
      ctx.fillStyle = "#fffbe6";
      ctx.shadowColor = "#ffe066";
      ctx.shadowBlur = 10;
      ctx.fill();
      ctx.restore();
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(pts[0].x, pts[0].y);
      for (let j = 1; j < pts.length; j++) {
        ctx.lineTo(pts[j].x, pts[j].y);
      }
      ctx.strokeStyle = "#ffe066";
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.restore();
    }
  }

  function drawOverflow() {
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(30, overflowY);
    for (let i = 0; i <= 20; i++) {
      const x = 30 + i * 12;
      const y = overflowY + Math.sin(i/2 + t/4) * 8 + Math.random()*2;
      ctx.lineTo(x, y);
    }
    ctx.lineTo(w-30, h+40);
    ctx.lineTo(30, h+40);
    ctx.closePath();
    ctx.fillStyle = "#fffbe6";
    ctx.shadowColor = "#ffe066";
    ctx.shadowBlur = 10;
    ctx.fill();
    ctx.restore();
    ctx.save();
    ctx.globalAlpha = 0.5;
    ctx.beginPath();
    ctx.moveTo(30, overflowY+10);
    ctx.lineTo(w-30, overflowY+10);
    ctx.lineTo(w-30, h+40);
    ctx.lineTo(30, h+40);
    ctx.closePath();
    ctx.fillStyle = "#ffb347";
    ctx.fill();
    ctx.restore();
  }

  function animate() {
    ctx.clearRect(0,0,w,h);

    drawContainer();
    drawCream();
    if (!overflow) drawPaintStream();
    drawInlet();

    if (overflow) {
      drawOverflow();
      overflowY += 2 + overflowStep*0.5;
      overflowStep += 0.2;
      if (overflowY > h+30) {
        if (!overflowDone) {
          drawOverflow();
          overflowDone = true;
        }
        return;
      }
    }

    t++;
    if (!overflow && t % 12 === 0) addCreamLayer();
    if (!overflow && creamLayers.length >= 12) {
      overflow = true;
    }
    if (!(overflow && overflowY > h+30)) {
      requestAnimationFrame(animate);
    }
  }
  animate();
}
  </script>
</body>
</html>